<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.breaktheice.moimat.persistence.TeamPostMapper">

	<select id="selectPost" resultType="com.breaktheice.moimat.domain.TeamPostDomain">
		select * from team_post where post_id = #{postId} and brd_id = #{brdId}
	</select>

	<select id="selectAllPosts" resultType="com.breaktheice.moimat.domain.TeamPostDomain">
		select * from team_post where team_id = #{ teamId } and brd_id = #{ brdId } order by post_id desc
	</select>

	<insert id="insertPost" parameterType="com.breaktheice.moimat.domain.TeamPostDomain">
		insert into team_post(post_id, team_id, brd_id, post_title, post_content, tmem_id, post_tmem_level, post_nickname, post_email, post_regdate, post_update, post_hit)
		values(TEAM_POST_SEQ.nextval, #{ teamId }, #{ brdId }, #{ postTitle }, #{ postContent }, #{ tmemId }, #{ postTmemLevel }, #{ postNickname }, #{ postEmail }, sysdate, sysdate, 0)
		<selectKey resultType="Long" keyProperty="postId" order="AFTER">
			select TEAM_POST_SEQ.currval from dual
		</selectKey>
	</insert>

	<update id="updatePost" parameterType="com.breaktheice.moimat.domain.TeamPostDomain">
		update TEAM_POST
		set POST_TITLE = #{ postTitle }, POST_CONTENT = #{ postContent }, POST_UPDATE = sysdate where POST_ID = #{ postId }
	</update>

	<delete id="deletePost">
		delete from TEAM_POST where post_id = #{ postId }
	</delete>

	<update id="updateViewCount">
		update TEAM_POST set POST_HIT = POST_HIT + 1 where POST_ID = #{ postId }
	</update>
</mapper>